### Cassandra 简介

Apache Cassandra是一个高度可扩展的高性能分布式数据库，用于处理大量商用服务器上的大量数据，提供高可用性，无单点故障。是一种NoSQL类型的数据库。

### NoSQL 数据库

NoSQL数据库（有时称为“不是唯一的SQL”）是一种数据库，它提供一种机制来存储和检索数据，而不是关系数据库中使用的表格关系。这些数据库是无架构的，支持简单的复制，具有简单的API，最终一致，并且可以处理大量的数据。

NoSQL数据库的主要目的在于

* 设计简单
* 水平缩放
* 更好地控制可用性
* 与关系数据库相比，NoSql数据库使用不同的数据结构。它使NoSQL中的一些操作更快。给定NoSQL数据库的适用性取决于它必须解决的问题。

### NoSQL数据库与关系数据库

下表列出了区分从NoSQL的数据库关系数据库的各点。

|关系数据库|NoSQL数据库|
|---|---|
|支持强大的查询语言|	支持非常简单的查询语言。
|它具有固定的模式|无固定模式。
|遵循ACID（原子性，一致性，隔离性和持久性）|只有“最终一致”。
|支持事务|不支持事务|

下面列出了Apache Cassandra的一些值得注意的地方：

* 它是可扩展，容错和一致的。

* 它是一个面向列的数据库。

* 它的分布设计基于Amazon的Dynamo及其在Google的Bigtable上的数据模型。

* 创建在Facebook，它与关系数据库管理系统有很大的不同。

* Cassandra实现了一个没有单点故障的Dynamo风格的复制模型，但增加了一个更强大的“列族”数据模型。

* Cassandra被一些最大的公司使用，如Facebook，Twitter，Cisco，Rackspace，ebay，Netflix等。

### Cassandra的特点

* 弹性可扩展性 - Cassandra是高度可扩展的; 它允许添加更多的硬件以适应更多的客户和更多的数据根据要求。

* 始终基于架构 - Cassandra没有单点故障，它可以连续用于不能承担故障的关键业务应用程序。
 
* 快速线性性能 - Cassandra是线性可扩展性的，即它为你增加集群中的节点数量增加你的吞吐量。因此，保持一个快速的响应时间。

* 灵活的数据存储 - Cassandra适应所有可能的数据格式，包括：结构化，半结构化和非结构化。它可以根据您的需要动态地适应变化的数据结构。

* 便捷的数据分发 - Cassandra通过在多个数据中心之间复制数据，可以灵活地在需要时分发数据。

* 事务支持 - Cassandra支持属性，如原子性，一致性，隔离和持久性（ACID）。

* 快速写入 - Cassandra被设计为在廉价的商品硬件上运行。 它执行快速写入，并可以存储数百TB的数据，而不牺牲读取效率。


### Cassandra 架构

Cassandra的设计目的是处理跨多个节点的大数据工作负载，而没有任何单点故障。Cassandra在其节点之间具有对等分布式系统，并且数据分布在集群中的所有节点之间。

集群中的所有节点都扮演相同的角色。 每个节点是独立的，并且同时互连到其他节点。

集群中的每个节点都可以接受读取和写入请求，无论数据实际位于集群中的何处。

当节点关闭时，可以从网络中的其他节点提供读/写请求。

### Cassandra中的数据复制

在Cassandra中，集群中的一个或多个节点充当给定数据片段的副本。如果检测到一些节点以过期值响应，Cassandra将向客户端返回最近的值。返回最新的值后，Cassandra在后台执行读修复以更新失效值。

下图显示了Cassandra如何在集群中的节点之间使用数据复制，以确保没有单点故障的示意图。

![image](./images/Cassandra入门/1.jpg)

### Cassandra的组件


* 节点 - 它是存储数据的地方。

* 数据中心 - 它是相关节点的集合。

* 集群 - 集群是包含一个或多个数据中心的组件。

* 提交日志 - 提交日志是Cassandra中的崩溃恢复机制。每个写操作都写入提交日志。

* Mem-表 - mem-表是存储器驻留的数据结构。提交日志后，数据将被写入mem表。有时，对于单列族，将有多个mem表。

* SSTable - 它是一个磁盘文件，当其内容达到阈值时，数据从mem表中刷新。

* 布隆过滤器 - 这些只是快速，非确定性的算法，用于测试元素是否是集合的成员。它是一种特殊的缓存。 每次查询后访问Bloom过滤器。

### Cassandra 查询语言

用户可以使用Cassandra查询语言（CQL）通过其节点访问Cassandra。CQL将数据库（Keyspace）视为表的容器。 程序员使用cqlsh：提示以使用CQL或单独的应用程序语言驱动程序。

客户端针对其读写操作访问任何节点。该节点（协调器）在客户端和保存数据的节点之间播放代理。

#### 写操作
节点的每个写入活动都由写在节点中的提交日志捕获。稍后数据将被捕获并存储在存储器表中。每当内存表满时，数据将写入SStable数据文件。所有写入都会在整个集群中自动分区和复制。Cassandra会定期整合SSTables，丢弃不必要的数据。

### 读操作
在读操作，Cassandra 从MEM-表得到的值，并检查过滤器绽放找到保存所需数据的相应的SSTable。

### 引用文档

[Cassandra教程](https://www.w3cschool.cn/cassandra/cassandra_architecture.html)